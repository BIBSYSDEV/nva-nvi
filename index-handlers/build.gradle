plugins {
    id 'nva.nvi.java-conventions'
}
dependencies {
    implementation nvaCatalog.aws.apache.client
    implementation nvaCatalog.aws.java.sdk.core
    implementation nvaCatalog.aws.lambda.core
    implementation nvaCatalog.aws.lambda.events
    implementation nvaCatalog.aws.sdk2.dynamo
    implementation nvaCatalog.aws.sdk2.s3
    implementation nvaCatalog.bundles.logging
    implementation nvaCatalog.guava
    implementation nvaCatalog.jackson.core
    implementation nvaCatalog.jackson.databind
    implementation libs.aws.sdk2.regions
    implementation libs.aws.sdk2.sqs
    implementation libs.bundles.apachePoi
    implementation libs.bundles.jacksonjr
    implementation libs.com.auth0.jwt
    implementation libs.jena.core
    implementation libs.nva.commons.apigateway
    implementation libs.nva.commons.auth
    implementation libs.nva.commons.clients
    implementation libs.nva.commons.pagination
    implementation libs.nva.commons.secrets
    implementation libs.nva.core
    implementation libs.nva.json
    implementation libs.nva.language
    implementation libs.nva.s3
    implementation libs.opensearch.java
    implementation libs.opensearch.rest.client
    implementation project(':nvi-commons')

    testImplementation nvaCatalog.hamcrest
    testImplementation nvaCatalog.zalando
    testImplementation libs.bundles.cucumber
    testImplementation libs.bundles.testContainers
    testImplementation libs.bundles.testing
    testImplementation libs.dynamodDbLocal
    testImplementation libs.nva.identifiers
    testImplementation libs.openCsv
    testImplementation project(':nvi-test')
    testImplementation(testFixtures(project(":nvi-commons")))
}

test {
    useJUnitPlatform()
    environment("EXPANDED_RESOURCES_BUCKET", "persisted-resources")
    environment("SEARCH_INFRASTRUCTURE_API_HOST", "localhost")
    environment("SEARCH_INFRASTRUCTURE_AUTH_URI", "localhost")
    environment("SEARCH_INFRASTRUCTURE_API_URI", "localhost")
    environment("NVI_TABLE_NAME", "some-table")
    environment("ALLOWED_ORIGIN", "*")
    environment("API_HOST", "api.fake.nva.aws.unit.no")
    environment("CUSTOM_DOMAIN_BASE_PATH", "scientific-index")
    environment("BACKEND_CLIENT_AUTH_URL", "My url")
    environment("BACKEND_CLIENT_SECRET_NAME", "My secret name")
    environment("PERSISTED_INDEX_DOCUMENT_QUEUE_URL", "PersistedIndexDocumentQueue")
    environment("INDEX_DLQ", "IndexDlq")
    environment("INSTITUTION_REPORT_SEARCH_PAGE_SIZE", "4")
    environment("COGNITO_AUTHORIZER_URLS", "http://localhost:3000")
    environment("LOG_LEVEL", "trace")
}
